{"version":3,"sources":["webpack:///path---exporting-data-from-a-rails-appliocation-8f95d15d195c936dc547.js","webpack:///./.cache/json/exporting-data-from-a-rails-appliocation.json"],"names":["webpackJsonp","389","module","exports","data","contentfulBlog","title","subHeading","tags","slug","published","bannerimage","sizes","base64","aspectRatio","src","srcSet","content","childMarkdownRemark","html","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,gBAAkBC,MAAA,4CAAAC,WAAA,2DAAAC,KAAA,gBAAAC,KAAA,2CAAAC,UAAA,yBAAAC,aAAyPC,OAASC,OAAA,suJAA0BC,YAAA,mBAAAC,IAAA,uHAAAC,OAAA,8oBAAAJ,MAAA,oCAAqjLK,SAAYC,qBAAuBC,KAAA,kjwBAA87xBC,aAAgBX,KAAA","file":"path---exporting-data-from-a-rails-appliocation-8f95d15d195c936dc547.js","sourcesContent":["webpackJsonp([186439809089793],{\n\n/***/ 389:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"contentfulBlog\":{\"title\":\"Exporting data from a Rails's Application\",\"subHeading\":\"Exporting data from Rails models to *.csv and and *.xlsx\",\"tags\":\"Ruby On Rails\",\"slug\":\"exporting-data-from-a-rails-appliocation\",\"published\":\"2016-12-05T00:00+08:00\",\"bannerimage\":{\"sizes\":{\"base64\":\"data:image/jpeg;base64,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\",\"aspectRatio\":1.7777777777777777,\"src\":\"//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=780&q=50\",\"srcSet\":\"//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=195&h=110&q=50 195w,\\n//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=390&h=219&q=50 390w,\\n//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=780&h=439&q=50 780w,\\n//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=1170&h=658&q=50 1170w,\\n//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=1280&h=720&q=50 1280w\",\"sizes\":\"(max-width: 780px) 100vw, 780px\"}},\"content\":{\"childMarkdownRemark\":{\"html\":\"<p>If you’ve got a Rails Application and want to export information from the database there are many options. We’ll use Rail’s ability to <a href=\\\"http://guides.rubyonrails.org/action_controller_overview.html#restful-downloads\\\">respond to different formats</a> within the standard RESTful routes to export data from the Student and School models in the sample app (view the repository <a href=\\\"https://github.com/105ron/csv-export\\\">here</a>).</p>\\n<p>The application is hosted on Heroku <a href=\\\"https://export-csv-sample.herokuapp.com/\\\">here</a> and has been seeded with some basic data. Each student ‘belongs_to’ a school which has it’s own model that contains the school’s name and address.</p>\\n<h3>Export to CSV</h3>\\n<p>First we will start with exporting a comma separated value file. This file is very simple, can be read by text editors and widely supported so it will allow you to import the data into another application.</p>\\n<p>The CSV class is now included in the standard Ruby library since ~> 1.9.2 so all we have to do is to ‘require CSV’ within the Rail’s Application. Although it is a simple format, it can be troublesome to save and load data which itself contains quotes and commas.</p>\\n<p>In the sample application the goal is to save the data in the student model and the rows association data in the school model. To do this we will use the ActiveRecord <a href=\\\"http://guides.rubyonrails.org/active_record_querying.html#joins\\\">joins</a> and <a href=\\\"http://guides.rubyonrails.org/active_record_querying.html#selecting-specific-fields\\\">select</a> methods to query our database and return our Student::ActiveRecord_Relation.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token keyword\\\">require</span> <span class=\\\"token string\\\">'csv'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Student</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token constant\\\">ApplicationRecord</span>\\n  \\n  belongs_to <span class=\\\"token symbol\\\">:school</span>\\n  \\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">]</span>\\n  \\n  <span class=\\\"token keyword\\\">def</span> <span class=\\\"token keyword\\\">self</span><span class=\\\"token punctuation\\\">.</span>all_with_school_details\\n    <span class=\\\"token constant\\\">Student</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">select</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"students.*, schools.name as school_name, schools.address as school_address\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">joins</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token symbol\\\">:school</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n  \\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">]</span>\\n  \\n<span class=\\\"token keyword\\\">end</span>\\n\\n<span class=\\\"token comment\\\">#ActiveRecord will turn this into the following SQL</span>\\n\\n<span class=\\\"token comment\\\">#SELECT students.*, schools.name as school_name, schools.address as school_address </span>\\n<span class=\\\"token comment\\\">#FROM \\\"students\\\" INNER JOIN \\\"schools\\\" ON \\\"schools\\\".\\\"id\\\" = \\\"students\\\".\\\"school_id\\\";</span></code></pre>\\n      </div>\\n<p>If we open the Rail’s Console and run the code you will notice it does not return the fields from the joined schools table.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token constant\\\">Student</span><span class=\\\"token punctuation\\\">.</span>all_with_school_details<span class=\\\"token punctuation\\\">.</span>first\\n\\n<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> <span class=\\\"token comment\\\">#&lt;Student:0x007f9c26baa580</span>\\n id<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span>\\n first_name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Bart\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n last_name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Simpson\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n <span class=\\\"token constant\\\">DOB</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token constant\\\">Sun</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">17</span> <span class=\\\"token constant\\\">Dec</span> <span class=\\\"token number\\\">1989</span><span class=\\\"token punctuation\\\">,</span>\\n email<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"bart@the-simpsons.com\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n created_at<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token constant\\\">Sun</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">04</span> <span class=\\\"token constant\\\">Dec</span> <span class=\\\"token number\\\">2016</span> <span class=\\\"token number\\\">06</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">26</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">52</span> <span class=\\\"token constant\\\">UTC</span> <span class=\\\"token operator\\\">+</span><span class=\\\"token number\\\">00</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">00</span><span class=\\\"token punctuation\\\">,</span>\\n updated_at<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token constant\\\">Sun</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">04</span> <span class=\\\"token constant\\\">Dec</span> <span class=\\\"token number\\\">2016</span> <span class=\\\"token number\\\">06</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">26</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">52</span> <span class=\\\"token constant\\\">UTC</span> <span class=\\\"token operator\\\">+</span><span class=\\\"token number\\\">00</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">00</span><span class=\\\"token punctuation\\\">,</span>\\nschool_id<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token number\\\">1</span><span class=\\\"token operator\\\">></span></code></pre>\\n      </div>\\n<p>ActiveRecord will only return items in Student class. To see the fully joined result we would need to open the database. (Postgres in this case and *psql csv-export_development *from the terminal {not the Rail’s console} to open the database, then we can run the raw SQL) We can however check from the console the columns are included in the result by chaining the column name (and including first so we only have one result) onto the end of the method like so…</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token constant\\\">Student</span><span class=\\\"token punctuation\\\">.</span>all_with_school_details<span class=\\\"token punctuation\\\">.</span>first<span class=\\\"token punctuation\\\">.</span>school_name\\n\\n<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> <span class=\\\"token string\\\">\\\"Springfield Elementary School\\\"</span></code></pre>\\n      </div>\\n<p>Now that we have our complete ActiveRecord object we need a method in the Student model to turn it into a CSV.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"text\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">def self.as_csv\\n  CSV.generate do |csv|\\n    columns = %w(id first_name last_name DOB school_name school_address)\\n    csv &lt;&lt; columns.map(&amp;:humanize)\\n    all_with_school_details.each do |student|\\n      csv &lt;&lt; student.attributes.values_at(*columns)\\n    end\\n  end\\nend</code></pre>\\n      </div>\\n<p>Here we create an array ‘columns’ with the names of the columns in our table we wish to be included in the CSV file. As we renamed the columns in the schools table via the ActiveRecord query (i.e. schools.name as school<em>name) we must now use ‘school</em>name’ and ‘school_address’ to access the data in these columns. We use Ruby’s <a href=\\\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-map\\\">map</a> enumerable and Rail’s <a href=\\\"http://apidock.com/rails/String/humanize\\\">humanize</a> method to create the first row in the CSV file from the columns array, this will be the title for each column.</p>\\n<p>Then we use the class method we created earlier with all the data from the tables in the database with the <a href=\\\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-each\\\">each</a> enumerable to add a new row for every record in the students table. Now all we need is to be able call this method from within our controller.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">students <span class=\\\"token constant\\\">GET</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token function\\\">students</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token symbol\\\">:format</span><span class=\\\"token punctuation\\\">)</span> students<span class=\\\"token comment\\\">#index</span></code></pre>\\n      </div>\\n<p>You can see from the <em>Rail’s routes</em> that Rail’s standard RESTful routes allow use to use different formats apart from HTML.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token keyword\\\">def</span> index\\n  <span class=\\\"token variable\\\">@students</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">Student</span><span class=\\\"token punctuation\\\">.</span>all_with_school_details\\n\\n  respond_to <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>format<span class=\\\"token operator\\\">|</span>\\n    format<span class=\\\"token punctuation\\\">.</span>html\\n    format<span class=\\\"token punctuation\\\">.</span>csv <span class=\\\"token punctuation\\\">{</span> send_data <span class=\\\"token variable\\\">@students</span><span class=\\\"token punctuation\\\">.</span>as_csv <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>With the <a href=\\\"http://api.rubyonrails.org/classes/ActionController/MimeResponds.html\\\">respond_to</a> block we now allow a .csv request to <a href=\\\"http://api.rubyonrails.org/classes/ActionController/DataStreaming.html#method-i-send_data\\\">send_data</a> (save a file) from the ‘as_csv’ method we created earlier in the Student model. Now all we need is to include a link within the view of the app so a user can access the method.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">%</span><span class=\\\"token operator\\\">=</span> link_to <span class=\\\"token string\\\">\\\"Export CSV\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token function\\\">students_path</span><span class=\\\"token punctuation\\\">(</span>format<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:csv</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">%</span><span class=\\\"token operator\\\">></span></code></pre>\\n      </div>\\n<p>Which is just a matter of specifying the format in the normal Rail’s <a href=\\\"http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to\\\">link_to</a> helper. Now we have everything in place when we click the link we should see…</p>\\n<p><img src=\\\"https://cdn-images-1.medium.com/max/2216/1*IVDd5HJSAqDzW-eokE54Rw.png\\\" alt=\\\"Pop up to save the link\\\"><em>Pop up to save the link</em></p>\\n<p>Once we save an open the file we have all the the data from our tables saved to the local computer and easily viewable in a table like this.</p>\\n<p><img src=\\\"https://cdn-images-1.medium.com/max/4012/1*CJkoXBUQ2m9_6EgjV5NIrw.png\\\" alt=\\\"Our CSV table generated through the Rail’s App.\\\"><em>Our CSV table generated through the Rail’s App.</em></p>\\n<h3>Export to XLSX</h3>\\n<p>The next challenge is to save to an XLSX file. For this will be using the <a href=\\\"https://github.com/straydogstudio/axlsx_rails\\\">Axlsx-Rail’s — Spreadsheet templates for Rail’s</a> gem. The first step will be to include the required Gems in the Rail’s App Gemfile…</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">wb <span class=\\\"token operator\\\">=</span> xlsx_package<span class=\\\"token punctuation\\\">.</span>workbook\\nwb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_worksheet</span><span class=\\\"token punctuation\\\">(</span>name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Student\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>sheet<span class=\\\"token operator\\\">|</span>\\n  title <span class=\\\"token operator\\\">=</span> wb<span class=\\\"token punctuation\\\">.</span>styles<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_style</span><span class=\\\"token punctuation\\\">(</span>b<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">true</span><span class=\\\"token punctuation\\\">,</span> bg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"395870\\\"</span><span class=\\\"token punctuation\\\">,</span> fg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"FFFFFF\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                              alignment<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>horizontal<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:center</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"ID\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Name\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Date of Birth\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Email\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                               <span class=\\\"token string\\\">\\\"School\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"School Address\\\"</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> style<span class=\\\"token punctuation\\\">:</span> title\\n  <span class=\\\"token variable\\\">@students</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">each</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>student<span class=\\\"token operator\\\">|</span>\\n    sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span>student<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>full_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">DOB</span><span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>email<span class=\\\"token punctuation\\\">,</span>\\n                   student<span class=\\\"token punctuation\\\">.</span>school_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>school_address<span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>Once added to the Gemfile we must save and run* bundle install* from the terminal. Now we have installed it, it would be wise to look at the <a href=\\\"https://github.com/randym/axlsx\\\">readme for the Aslsx gem</a>. You will see it allows you to do quite a lot but there are known issues with Google Docs, Libre Office and Apple Numbers. You should check these and make sure it is the right option for you app.</p>\\n<p>We will use the <em>all<em>with</em>school_details</em> class method we created in the CSV section to provide the data. This gem requires us to make view with the extension *<em>.xlsx.axlsx</em>. So we will setup the controller to respond to XLSX requests and add a link to <em>index.html.erb</em> like so…</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">wb <span class=\\\"token operator\\\">=</span> xlsx_package<span class=\\\"token punctuation\\\">.</span>workbook\\nwb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_worksheet</span><span class=\\\"token punctuation\\\">(</span>name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Student\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>sheet<span class=\\\"token operator\\\">|</span>\\n  title <span class=\\\"token operator\\\">=</span> wb<span class=\\\"token punctuation\\\">.</span>styles<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_style</span><span class=\\\"token punctuation\\\">(</span>b<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">true</span><span class=\\\"token punctuation\\\">,</span> bg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"395870\\\"</span><span class=\\\"token punctuation\\\">,</span> fg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"FFFFFF\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                              alignment<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>horizontal<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:center</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"ID\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Name\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Date of Birth\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Email\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                               <span class=\\\"token string\\\">\\\"School\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"School Address\\\"</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> style<span class=\\\"token punctuation\\\">:</span> title\\n  <span class=\\\"token variable\\\">@students</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">each</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>student<span class=\\\"token operator\\\">|</span>\\n    sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span>student<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>full_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">DOB</span><span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>email<span class=\\\"token punctuation\\\">,</span>\\n                   student<span class=\\\"token punctuation\\\">.</span>school_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>school_address<span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>Now it is a matter of creating the view and reading the <a href=\\\"http://www.rubydoc.info/github/randym/axlsx/toplevel\\\">documentation</a> to output the XLSX file with the data and format desire. The view extension must be *<em>.xlsx.axlsx *and as we are in the Students#index we will call the file *index.xlsx.axlsx *in the */app/views/students</em> folder which means we are using the Standard Rail’s convention.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">wb <span class=\\\"token operator\\\">=</span> xlsx_package<span class=\\\"token punctuation\\\">.</span>workbook\\nwb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_worksheet</span><span class=\\\"token punctuation\\\">(</span>name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Student\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>sheet<span class=\\\"token operator\\\">|</span>\\n  title <span class=\\\"token operator\\\">=</span> wb<span class=\\\"token punctuation\\\">.</span>styles<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_style</span><span class=\\\"token punctuation\\\">(</span>b<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">true</span><span class=\\\"token punctuation\\\">,</span> bg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"395870\\\"</span><span class=\\\"token punctuation\\\">,</span> fg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"FFFFFF\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                              alignment<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>horizontal<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:center</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"ID\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Name\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Date of Birth\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Email\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                               <span class=\\\"token string\\\">\\\"School\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"School Address\\\"</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> style<span class=\\\"token punctuation\\\">:</span> title\\n  <span class=\\\"token variable\\\">@students</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">each</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>student<span class=\\\"token operator\\\">|</span>\\n    sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span>student<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>full_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">DOB</span><span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>email<span class=\\\"token punctuation\\\">,</span>\\n                   student<span class=\\\"token punctuation\\\">.</span>school_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>school_address<span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>The above code in the view above will style the headings like on the <a href=\\\"https://export-csv-sample.herokuapp.com/\\\">website</a>. There is many styling options which can be applied to individual columns and the ability to create multiple sheets in the one file.</p>\\n<p><img src=\\\"https://cdn-images-1.medium.com/max/5168/1*rQcwMEwWWORDrZCG7aZ4Mg.png\\\" alt=\\\"The final output of students.xlsx\\\"><em>The final output of students.xlsx</em></p>\\n<p>Once you click and save the file you can see here the output of the App. It looks very similar to the CSV but the AXSLX gem includes many more features not included in this article and not available with simple CSV file exports.</p>\\n<h3>Conclusion</h3>\\n<p>Working with Rail’s conventions makes exporting data from your models straightforward. F]If you have any problems you can contact me on Twitter <a href=\\\"https://twitter.com/rhysonrails\\\">@rhysonrails</a> or click the email link below to send me an email.</p>\"}}}},\"pathContext\":{\"slug\":\"exporting-data-from-a-rails-appliocation\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---exporting-data-from-a-rails-appliocation-8f95d15d195c936dc547.js","module.exports = {\"data\":{\"contentfulBlog\":{\"title\":\"Exporting data from a Rails's Application\",\"subHeading\":\"Exporting data from Rails models to *.csv and and *.xlsx\",\"tags\":\"Ruby On Rails\",\"slug\":\"exporting-data-from-a-rails-appliocation\",\"published\":\"2016-12-05T00:00+08:00\",\"bannerimage\":{\"sizes\":{\"base64\":\"data:image/jpeg;base64,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\",\"aspectRatio\":1.7777777777777777,\"src\":\"//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=780&q=50\",\"srcSet\":\"//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=195&h=110&q=50 195w,\\n//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=390&h=219&q=50 390w,\\n//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=780&h=439&q=50 780w,\\n//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=1170&h=658&q=50 1170w,\\n//images.ctfassets.net/dbj3qsde8a1y/30YeXYPb2M2KQiICuWessS/9fb81cac2d6fc24009420392baa6d441/promo_179.jpg?w=1280&h=720&q=50 1280w\",\"sizes\":\"(max-width: 780px) 100vw, 780px\"}},\"content\":{\"childMarkdownRemark\":{\"html\":\"<p>If you’ve got a Rails Application and want to export information from the database there are many options. We’ll use Rail’s ability to <a href=\\\"http://guides.rubyonrails.org/action_controller_overview.html#restful-downloads\\\">respond to different formats</a> within the standard RESTful routes to export data from the Student and School models in the sample app (view the repository <a href=\\\"https://github.com/105ron/csv-export\\\">here</a>).</p>\\n<p>The application is hosted on Heroku <a href=\\\"https://export-csv-sample.herokuapp.com/\\\">here</a> and has been seeded with some basic data. Each student ‘belongs_to’ a school which has it’s own model that contains the school’s name and address.</p>\\n<h3>Export to CSV</h3>\\n<p>First we will start with exporting a comma separated value file. This file is very simple, can be read by text editors and widely supported so it will allow you to import the data into another application.</p>\\n<p>The CSV class is now included in the standard Ruby library since ~> 1.9.2 so all we have to do is to ‘require CSV’ within the Rail’s Application. Although it is a simple format, it can be troublesome to save and load data which itself contains quotes and commas.</p>\\n<p>In the sample application the goal is to save the data in the student model and the rows association data in the school model. To do this we will use the ActiveRecord <a href=\\\"http://guides.rubyonrails.org/active_record_querying.html#joins\\\">joins</a> and <a href=\\\"http://guides.rubyonrails.org/active_record_querying.html#selecting-specific-fields\\\">select</a> methods to query our database and return our Student::ActiveRecord_Relation.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token keyword\\\">require</span> <span class=\\\"token string\\\">'csv'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Student</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token constant\\\">ApplicationRecord</span>\\n  \\n  belongs_to <span class=\\\"token symbol\\\">:school</span>\\n  \\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">]</span>\\n  \\n  <span class=\\\"token keyword\\\">def</span> <span class=\\\"token keyword\\\">self</span><span class=\\\"token punctuation\\\">.</span>all_with_school_details\\n    <span class=\\\"token constant\\\">Student</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">select</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">\\\"students.*, schools.name as school_name, schools.address as school_address\\\"</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">joins</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token symbol\\\">:school</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n  \\n  <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token punctuation\\\">]</span>\\n  \\n<span class=\\\"token keyword\\\">end</span>\\n\\n<span class=\\\"token comment\\\">#ActiveRecord will turn this into the following SQL</span>\\n\\n<span class=\\\"token comment\\\">#SELECT students.*, schools.name as school_name, schools.address as school_address </span>\\n<span class=\\\"token comment\\\">#FROM \\\"students\\\" INNER JOIN \\\"schools\\\" ON \\\"schools\\\".\\\"id\\\" = \\\"students\\\".\\\"school_id\\\";</span></code></pre>\\n      </div>\\n<p>If we open the Rail’s Console and run the code you will notice it does not return the fields from the joined schools table.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token constant\\\">Student</span><span class=\\\"token punctuation\\\">.</span>all_with_school_details<span class=\\\"token punctuation\\\">.</span>first\\n\\n<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> <span class=\\\"token comment\\\">#&lt;Student:0x007f9c26baa580</span>\\n id<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span>\\n first_name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Bart\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n last_name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Simpson\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n <span class=\\\"token constant\\\">DOB</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token constant\\\">Sun</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">17</span> <span class=\\\"token constant\\\">Dec</span> <span class=\\\"token number\\\">1989</span><span class=\\\"token punctuation\\\">,</span>\\n email<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"bart@the-simpsons.com\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n created_at<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token constant\\\">Sun</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">04</span> <span class=\\\"token constant\\\">Dec</span> <span class=\\\"token number\\\">2016</span> <span class=\\\"token number\\\">06</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">26</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">52</span> <span class=\\\"token constant\\\">UTC</span> <span class=\\\"token operator\\\">+</span><span class=\\\"token number\\\">00</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">00</span><span class=\\\"token punctuation\\\">,</span>\\n updated_at<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token constant\\\">Sun</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">04</span> <span class=\\\"token constant\\\">Dec</span> <span class=\\\"token number\\\">2016</span> <span class=\\\"token number\\\">06</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">26</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">52</span> <span class=\\\"token constant\\\">UTC</span> <span class=\\\"token operator\\\">+</span><span class=\\\"token number\\\">00</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">00</span><span class=\\\"token punctuation\\\">,</span>\\nschool_id<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token number\\\">1</span><span class=\\\"token operator\\\">></span></code></pre>\\n      </div>\\n<p>ActiveRecord will only return items in Student class. To see the fully joined result we would need to open the database. (Postgres in this case and *psql csv-export_development *from the terminal {not the Rail’s console} to open the database, then we can run the raw SQL) We can however check from the console the columns are included in the result by chaining the column name (and including first so we only have one result) onto the end of the method like so…</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token constant\\\">Student</span><span class=\\\"token punctuation\\\">.</span>all_with_school_details<span class=\\\"token punctuation\\\">.</span>first<span class=\\\"token punctuation\\\">.</span>school_name\\n\\n<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">></span> <span class=\\\"token string\\\">\\\"Springfield Elementary School\\\"</span></code></pre>\\n      </div>\\n<p>Now that we have our complete ActiveRecord object we need a method in the Student model to turn it into a CSV.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"text\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">def self.as_csv\\n  CSV.generate do |csv|\\n    columns = %w(id first_name last_name DOB school_name school_address)\\n    csv &lt;&lt; columns.map(&amp;:humanize)\\n    all_with_school_details.each do |student|\\n      csv &lt;&lt; student.attributes.values_at(*columns)\\n    end\\n  end\\nend</code></pre>\\n      </div>\\n<p>Here we create an array ‘columns’ with the names of the columns in our table we wish to be included in the CSV file. As we renamed the columns in the schools table via the ActiveRecord query (i.e. schools.name as school<em>name) we must now use ‘school</em>name’ and ‘school_address’ to access the data in these columns. We use Ruby’s <a href=\\\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-map\\\">map</a> enumerable and Rail’s <a href=\\\"http://apidock.com/rails/String/humanize\\\">humanize</a> method to create the first row in the CSV file from the columns array, this will be the title for each column.</p>\\n<p>Then we use the class method we created earlier with all the data from the tables in the database with the <a href=\\\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-each\\\">each</a> enumerable to add a new row for every record in the students table. Now all we need is to be able call this method from within our controller.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">students <span class=\\\"token constant\\\">GET</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token function\\\">students</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token symbol\\\">:format</span><span class=\\\"token punctuation\\\">)</span> students<span class=\\\"token comment\\\">#index</span></code></pre>\\n      </div>\\n<p>You can see from the <em>Rail’s routes</em> that Rail’s standard RESTful routes allow use to use different formats apart from HTML.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token keyword\\\">def</span> index\\n  <span class=\\\"token variable\\\">@students</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token constant\\\">Student</span><span class=\\\"token punctuation\\\">.</span>all_with_school_details\\n\\n  respond_to <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>format<span class=\\\"token operator\\\">|</span>\\n    format<span class=\\\"token punctuation\\\">.</span>html\\n    format<span class=\\\"token punctuation\\\">.</span>csv <span class=\\\"token punctuation\\\">{</span> send_data <span class=\\\"token variable\\\">@students</span><span class=\\\"token punctuation\\\">.</span>as_csv <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>With the <a href=\\\"http://api.rubyonrails.org/classes/ActionController/MimeResponds.html\\\">respond_to</a> block we now allow a .csv request to <a href=\\\"http://api.rubyonrails.org/classes/ActionController/DataStreaming.html#method-i-send_data\\\">send_data</a> (save a file) from the ‘as_csv’ method we created earlier in the Student model. Now all we need is to include a link within the view of the app so a user can access the method.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">%</span><span class=\\\"token operator\\\">=</span> link_to <span class=\\\"token string\\\">\\\"Export CSV\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token function\\\">students_path</span><span class=\\\"token punctuation\\\">(</span>format<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:csv</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">%</span><span class=\\\"token operator\\\">></span></code></pre>\\n      </div>\\n<p>Which is just a matter of specifying the format in the normal Rail’s <a href=\\\"http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to\\\">link_to</a> helper. Now we have everything in place when we click the link we should see…</p>\\n<p><img src=\\\"https://cdn-images-1.medium.com/max/2216/1*IVDd5HJSAqDzW-eokE54Rw.png\\\" alt=\\\"Pop up to save the link\\\"><em>Pop up to save the link</em></p>\\n<p>Once we save an open the file we have all the the data from our tables saved to the local computer and easily viewable in a table like this.</p>\\n<p><img src=\\\"https://cdn-images-1.medium.com/max/4012/1*CJkoXBUQ2m9_6EgjV5NIrw.png\\\" alt=\\\"Our CSV table generated through the Rail’s App.\\\"><em>Our CSV table generated through the Rail’s App.</em></p>\\n<h3>Export to XLSX</h3>\\n<p>The next challenge is to save to an XLSX file. For this will be using the <a href=\\\"https://github.com/straydogstudio/axlsx_rails\\\">Axlsx-Rail’s — Spreadsheet templates for Rail’s</a> gem. The first step will be to include the required Gems in the Rail’s App Gemfile…</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">wb <span class=\\\"token operator\\\">=</span> xlsx_package<span class=\\\"token punctuation\\\">.</span>workbook\\nwb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_worksheet</span><span class=\\\"token punctuation\\\">(</span>name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Student\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>sheet<span class=\\\"token operator\\\">|</span>\\n  title <span class=\\\"token operator\\\">=</span> wb<span class=\\\"token punctuation\\\">.</span>styles<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_style</span><span class=\\\"token punctuation\\\">(</span>b<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">true</span><span class=\\\"token punctuation\\\">,</span> bg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"395870\\\"</span><span class=\\\"token punctuation\\\">,</span> fg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"FFFFFF\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                              alignment<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>horizontal<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:center</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"ID\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Name\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Date of Birth\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Email\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                               <span class=\\\"token string\\\">\\\"School\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"School Address\\\"</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> style<span class=\\\"token punctuation\\\">:</span> title\\n  <span class=\\\"token variable\\\">@students</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">each</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>student<span class=\\\"token operator\\\">|</span>\\n    sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span>student<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>full_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">DOB</span><span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>email<span class=\\\"token punctuation\\\">,</span>\\n                   student<span class=\\\"token punctuation\\\">.</span>school_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>school_address<span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>Once added to the Gemfile we must save and run* bundle install* from the terminal. Now we have installed it, it would be wise to look at the <a href=\\\"https://github.com/randym/axlsx\\\">readme for the Aslsx gem</a>. You will see it allows you to do quite a lot but there are known issues with Google Docs, Libre Office and Apple Numbers. You should check these and make sure it is the right option for you app.</p>\\n<p>We will use the <em>all<em>with</em>school_details</em> class method we created in the CSV section to provide the data. This gem requires us to make view with the extension *<em>.xlsx.axlsx</em>. So we will setup the controller to respond to XLSX requests and add a link to <em>index.html.erb</em> like so…</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">wb <span class=\\\"token operator\\\">=</span> xlsx_package<span class=\\\"token punctuation\\\">.</span>workbook\\nwb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_worksheet</span><span class=\\\"token punctuation\\\">(</span>name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Student\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>sheet<span class=\\\"token operator\\\">|</span>\\n  title <span class=\\\"token operator\\\">=</span> wb<span class=\\\"token punctuation\\\">.</span>styles<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_style</span><span class=\\\"token punctuation\\\">(</span>b<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">true</span><span class=\\\"token punctuation\\\">,</span> bg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"395870\\\"</span><span class=\\\"token punctuation\\\">,</span> fg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"FFFFFF\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                              alignment<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>horizontal<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:center</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"ID\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Name\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Date of Birth\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Email\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                               <span class=\\\"token string\\\">\\\"School\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"School Address\\\"</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> style<span class=\\\"token punctuation\\\">:</span> title\\n  <span class=\\\"token variable\\\">@students</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">each</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>student<span class=\\\"token operator\\\">|</span>\\n    sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span>student<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>full_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">DOB</span><span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>email<span class=\\\"token punctuation\\\">,</span>\\n                   student<span class=\\\"token punctuation\\\">.</span>school_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>school_address<span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>Now it is a matter of creating the view and reading the <a href=\\\"http://www.rubydoc.info/github/randym/axlsx/toplevel\\\">documentation</a> to output the XLSX file with the data and format desire. The view extension must be *<em>.xlsx.axlsx *and as we are in the Students#index we will call the file *index.xlsx.axlsx *in the */app/views/students</em> folder which means we are using the Standard Rail’s convention.</p>\\n<div class=\\\"gatsby-highlight\\\" data-language=\\\"ruby\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">wb <span class=\\\"token operator\\\">=</span> xlsx_package<span class=\\\"token punctuation\\\">.</span>workbook\\nwb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_worksheet</span><span class=\\\"token punctuation\\\">(</span>name<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"Student\\\"</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>sheet<span class=\\\"token operator\\\">|</span>\\n  title <span class=\\\"token operator\\\">=</span> wb<span class=\\\"token punctuation\\\">.</span>styles<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">add_style</span><span class=\\\"token punctuation\\\">(</span>b<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">true</span><span class=\\\"token punctuation\\\">,</span> bg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"395870\\\"</span><span class=\\\"token punctuation\\\">,</span> fg_color<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"FFFFFF\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                              alignment<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>horizontal<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:center</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span><span class=\\\"token string\\\">\\\"ID\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Name\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Date of Birth\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Email\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n                               <span class=\\\"token string\\\">\\\"School\\\"</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"School Address\\\"</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> style<span class=\\\"token punctuation\\\">:</span> title\\n  <span class=\\\"token variable\\\">@students</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">each</span> <span class=\\\"token keyword\\\">do</span> <span class=\\\"token operator\\\">|</span>student<span class=\\\"token operator\\\">|</span>\\n    sheet<span class=\\\"token punctuation\\\">.</span>add_row <span class=\\\"token punctuation\\\">[</span>student<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>full_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">DOB</span><span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>email<span class=\\\"token punctuation\\\">,</span>\\n                   student<span class=\\\"token punctuation\\\">.</span>school_name<span class=\\\"token punctuation\\\">,</span> student<span class=\\\"token punctuation\\\">.</span>school_address<span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>The above code in the view above will style the headings like on the <a href=\\\"https://export-csv-sample.herokuapp.com/\\\">website</a>. There is many styling options which can be applied to individual columns and the ability to create multiple sheets in the one file.</p>\\n<p><img src=\\\"https://cdn-images-1.medium.com/max/5168/1*rQcwMEwWWORDrZCG7aZ4Mg.png\\\" alt=\\\"The final output of students.xlsx\\\"><em>The final output of students.xlsx</em></p>\\n<p>Once you click and save the file you can see here the output of the App. It looks very similar to the CSV but the AXSLX gem includes many more features not included in this article and not available with simple CSV file exports.</p>\\n<h3>Conclusion</h3>\\n<p>Working with Rail’s conventions makes exporting data from your models straightforward. F]If you have any problems you can contact me on Twitter <a href=\\\"https://twitter.com/rhysonrails\\\">@rhysonrails</a> or click the email link below to send me an email.</p>\"}}}},\"pathContext\":{\"slug\":\"exporting-data-from-a-rails-appliocation\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/exporting-data-from-a-rails-appliocation.json\n// module id = 389\n// module chunks = 186439809089793"],"sourceRoot":""}